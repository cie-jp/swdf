/***************************************************************** 
 *
 * 行列の固有値計算関係
 *
 *
 *                           Created  by Mamoru Ota (2018/03/09)
 * 
 *****************************************************************/

#include"MATRIX.h"

// *******************************************************************
// 実2重対角行列
//            | b0[0]  b1[0]     0      0  ...         0          0  |
//            |    0   b0[1]  b1[1]     0  ...         .          .  |
//            |    0      0   b0[2]  b1[2] ...         .          .  |
// B        = |    0      0      0   b0[3] ...         .          .  |
//            |    .      .      .      .              0          0  |
//            |    0      0      0      0       b1[n - 3]         0  |
//            |    0      0      0      0  ...  b0[n - 2]  b1[n - 2] | 
//            |    0      0      0      0  ...         0   b0[n - 1] |
// について, 3重対角行列
//            | t0[0]  t1[0]     0      0  ...         0          0  |
//            | t1[0]  t0[1]  t1[1]     0  ...         .          .  |
//            |    0   t1[1]  t0[2]  t1[2] ...         .          .  |
// B^{T}B   = |    0      0   t1[2]  t0[3] ...         .          .  |
//            |    .      .      .      .              0          0  |
//            |    0      0      0      0  ...  t1[n - 3]         0  | 
//            |    0      0      0      0  ...  t0[n - 2]  t1[n - 2] | 
//            |    0      0      0      0  ...  t1[n - 2]  t0[n - 1] |
// のT0, T1を計算する. 
// *******************************************************************
void REAL__MATRIX_BTB(REAL t0[],//(out)[n]     : 3重対角行列の対角成分
                      REAL t1[],//(out)[n - 1] : 3重対角行列の非対角成分
                      REAL b0[],//(in) [n]     : 2重対角行列の対角成分
                      REAL b1[],//(in) [n - 1] : 2重対角行列の非対角成分
                      INT  n){  //(in)         : 2重対角行列の次元数
  INT i;
  
  t0[0] = REAL__MUL(b0[0],b0[0]);
  for(i = 1;i < n    ;i++){
    t0[i] = REAL__ADD(REAL__MUL(b0[i],b0[i]),REAL__MUL(b1[i - 1],b1[i - 1]));
  }

  for(i = 0;i < n - 1;i++){
    t1[i] = REAL__MUL(b0[i],b1[i]);
  }  
}
